<!doctype html>
<html lang="en">

<head>
    <title>JEWELRY</title>
    <link rel="shortcut icon" href="img/logo/logo.png">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="assets/css/index.css">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.css">
    <link rel="stylesheet" href="assets/css/bootstrap-grid.css">
    <link rel="stylesheet" href="assets/css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-grid.rtl.css">
    <link rel="stylesheet" href="assets/css/bootstrap-grid.rtl.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-reboot.css">
    <link rel="stylesheet" href="assets/css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-reboot.rtl.css">
    <link rel="stylesheet" href="assets/css/bootstrap-utilities.css">
    <link rel="stylesheet" href="assets/css/bootstrap-utilities.min.css">
    <link rel="stylesheet" href="assets/css/bootstrap-utilities.rtl.css">
    <link rel="stylesheet" href="assets/css/bootstrap.rtl.css">
    <link rel="stylesheet" href="assets/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="assets/css/all.css">
    <link rel="stylesheet" href="assets/css/all.min.css">

    <!-- Bootstrap CSS v5.2.1 -->


</head>

<body>
    <header class="container card mb-3" style="border: 2px solid rgb(235, 115, 167);">
        <ul class="nav nav-tabs nav-stacked row container" style="padding: 10px   10px;">
            <li class="nav-item col-lg-3 col-sm-12 ">
                <picture>
                    <img src="img/logo/logo.png"
                        style="max-width: 50%; margin: 10px 10px; display: block; padding: auto; margin: auto; "
                        alt="image desc">
                </picture>
            </li>
            <li class="nav-item col-lg-6 row"
                style="margin: 10px 0px; border: solid 1px rgb(235, 115, 167); border-radius: 20px;">
                <a href="index.html" class="nav-link col">Trang chủ</a>
                <a href="TrangCuaHang.html" class="nav-link col">Cửa hàng</a>
                <a href="#" class="nav-link col">Giới Thiệu</a>
                <a href="./lienhe.html" class="nav-link col">Liên hệ</a>
            </li>
            <li class="nav-item disabled col-lg-3 row p-1"
                style="margin: 10px 0px; border: 1px solid rgb(235, 115, 167); border-radius: 20px;">

                <a href="#" id="searchIcon" class="nav-link col fa fa-search" style="display: none;"></a>
                <div class="" id="searchBar">
                    <input type="text" name="" id="" class="form-control" placeholder="Tìm kiếm...">
                </div>
                <a href="dangnhap.html" class="nav-link col text-center"><i class="fa fa-user"></i></a>
                <a href="dangki.html" class="nav-link col text-center"><i class="fa fa-user-plus"></i></a>
                <a href="TrangQuanLySanPham.html" class="nav-link col text-center"><i class="fa fa-gears"></i></a>
            </li>
        </ul>
    </header>
    <main class="container">

        <div class="row">
            <div class="col-lg-3 text-end " id="sidebar">
                <div class="d-flex flex-column flex-shrink-0 p-3 h-100 card"
                    style="width: 100%; background-color: rgb(235, 115, 167);">
                    <a href="/" class="text-center text-decoration-none">
                        <span class="fs-4 text-white">QUẢN LÝ CHUNG</span>
                    </a>
                    <hr>
                    <div class="nav nav-pills row w-100">
                        <div class="nav-item  col-4 text-center text-lg-end col-lg-12">
                            <a href="/TrangQuanLyNguoiDung.html" id="ProductList" class="nav-link" aria-current="page">
                                Danh sách sản phẩm
                            </a>
                        </div>

                        <div class="nav-item col-4  text-center text-lg-end col-lg-12">
                            <a href="/TrangThemNguoiDung.html" id="ProductAdd" class="nav-link ">
                                Thêm sản phẩm
                            </a>
                        </div>



                        <div class="nav-item col-4  text-center text-lg-end col-lg-12">
                            <a href="/TrangQuanLyNguoiDung.html" id="UserList" class="nav-link ">
                                Danh sách người dùng
                            </a>
                        </div>

                        <div class="nav-item col-4  text-center text-lg-end col-lg-12">
                            <a href="/TrangThemNguoiDung.html" id="UserAdd" class="nav-link ">
                                Thêm người dùng
                            </a>
                        </div>


                    </div>
                    <hr>
                </div>
            </div>
            <div class="col-lg-9 col-12 card mt-3 mt-lg-0" style="border:rgb(235, 115, 167) solid 2px">
                <div style="height: 700px; overflow-y: auto; overflow-x: hidden;">
                    <table class="table ">
                        <thead>
                            <tr style="border-bottom: rgb(235, 115, 167) solid 2px; ">
                                <th class="col-1">Stt</th>
                                <th class="col-2">Mã người dùng</th>
                                <th class="col-3">Ảnh đại diện</th>
                                <th class="col-2">Họ và tên</th>
                                <th class="col-1">Số điện thoại</th>
                                <th class="col-1">Email</th>
                                <th class="col-2">Thao tác</th>
                            </tr>
                        </thead>

                        <tbody id="DanhSachNguoiDung">

                        </tbody>
                    </table>
                </div>


            </div>
        </div>
    </main>
    <footer class="p-3 container card mt-4" style="border: 2px solid rgb(235, 115, 167);">
        <div class="row">
            <div class="col-lg-3 col-4">
                <img src="img/logo/logo.png" class="img-fluid" alt="">
            </div>
            <div class="col-lg-9 card p-2" style="border: 1px solid rgb(235, 115, 167);">
                <h3 class="text-uppercase text-white text-center p-1" style="background-color: rgb(235, 115, 167);">Liên
                    hệ</h3>
                <div class=" card p-2">
                    <div class="mb-3">
                        <label for="" class="form-label">Email</label>
                        <input type="email" class="form-control" name="" id="" aria-describedby="emailHelpId"
                            placeholder="abc@mail.com">
                    </div>
                    <div class="mb-3">
                        <label for="" class="form-label">Nội dung</label> <br>
                        <textarea name="" id="" rows="4" style="width: 100%;"></textarea>
                    </div>
                    <div class="mb-3">
                        <button type="submit" class="btn text-white"
                            style="float: right; background-color: rgb(235, 115, 167);">Gửi</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="row text-center mt-4">
            <p>Bản quyền thuộc về &copy; CT188-Nhập môn lập trình web-Nhóm 11</p>
        </div>
    </footer>
    <!-- Bootstrap JavaScript Libraries -->
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/bootstrap.esm.min.js"></script>
    <script src="assets/js/bootstrap.esm.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/index.js"></script>
    <script src="assets/js/jquery.js"></script>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.Emailim.js"></script>
    <script src="assets/js/jquery.Emailim.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/all.js"></script>
    <script src="assets/js/all.min.js"></script>
    <script src="assets/js/bootstrap.bundle.js"></script>
    <script>
        //HIỂN THỊ DANH SÁCH NGƯỜI DÙNG
        // Lấy mảng sản phẩm từ local storage, nếu không có thì khởi tạo một mảng mới
        const CacNguoiDung = JSON.parse(localStorage.getItem('CacNguoiDung')) || [];
        var i = 1;
        // Hiển thị danh sách sản phẩm và hình ảnh trong ứng dụng
        $('#DanhSachNguoiDung').empty();
        for (const NguoiDung of CacNguoiDung) {
            $('#DanhSachNguoiDung').append(
                `
                <tr style="border: rgb(235, 115, 167) solid 2px;; " >
                    <td class="col-1 text-center">${i}</td>
                    <td class="col-2">${NguoiDung.MaKH}</td>
                    <td class="col-3"><img src="${NguoiDung.Avt}" alt="" class="img-responsive"
                            style="max-width: 50%;"></td>
                    <td class="col-2">${NguoiDung.HoTen}</td>
                    <td class="col-1">${NguoiDung.Email}</td>
                    <td class="col-1">${NguoiDung.SDT}</td>
                    <td class="col-2">
                        <a href="#" class="btn btn-success edit" data-bs-toggle="modal" data-bs-target="#modalId${i}"><i class="fa fa-pencil"></i></a>
                        <a href="#" class="btn btn-danger delete"><i class="fa fa-trash"></i></a>
                    
                    
                        
                        <div class="modal fade" id="modalId${i}" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
                            <div class="modal-dialog" role="document" >
                                <div class="modal-content">
                                        <div class="modal-header text-white " style="background-color: rgb(235, 115, 167);">
                                            <div  class="row w-100">
                                                <h5 class="modal-title col" id="modalTitleId">CẬP NHẬT NGƯỜI DÙNG</h5>
                                                <button type="button" class="btn-close col-1" data-bs-dismiss="modal" style="background-color:white" aria-label="Close"></button>
                                            </div>
                                            </div>
                                    <div class="modal-body">
                                        <div class="container-fluid">
                                            <form id="CapNhatNguoiDung">
                                                <div class="container">
                                                    <div class="mb-3">
                                                        <input type="text" class="form-control"  hidden  value="${NguoiDung.MaKH}" name="MaKH" id="MaKH" aria-describedby="helpId"
                                                            placeholder="Nhập tên sản phẩm tại đây">
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="" class="form-label text-uppercase" style="font-weight: bold;">Họ và Tên                                                         phẩm</label>
                                                        <input type="text" class="form-control"  value="${NguoiDung.HoTen}" name="CapNhatTenKH" id="CapNhatTenKH" aria-describedby="helpId"
                                                            placeholder="Nhập tên sản phẩm tại đây">
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="" class="form-label text-uppercase" style="font-weight: bold;">Email</label>
                                                        <input type="email" class="form-control"  value="${NguoiDung.Email}" name="CapNhatEmail" id="CapNhatEmail" aria-describedby="helpId"
                                                            placeholder="Nhập số lượng sản phẩm tại đây">
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="" class="form-label text-uppercase" style="font-weight: bold;">Số điện thoại</label>
                                                        <input type="text" class="form-control"  value="${NguoiDung.SDT}" name="CapNhatSDT" id="CapNhatSDT" aria-describedby="helpId"
                                                            placeholder="Nhập giá bán sản phẩm tại đây">
                                                    </div>
                                                    <div class="mb-3">
                                                        <label for="" class="form-label">Ảnh đại diện</label>
                                                        <input type="file" class="form-control"  name="CapNhatAvt" id="CapNhatAvt" placeholder=""
                                                            aria-describedby="fileHelpId">
                                                    </div>
                                                    <div class="mb-3">
                                                        <img src="${NguoiDung.Avt}" alt="" class="img-fluid"
                                                    </div>
                                                    <button type="submit" class="btn  m-2 text-white"
                                                        style="float: right;  background-color:  rgb(235, 115, 167);">Cập nhật người dùng</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                   
                                </div>
                            </div>
                        </div>
                      
                    </td>
                </tr>
            `
            );
            i++;
        }

    </script>
    <script>
        //XÓA NGUÒI DUNG
        // Lắng nghe sự kiện khi người dùng bấm nút "Xóa"
        $(document).on('click', '.delete', function () {
            // Lấy chỉ mục của sản phẩm trong danh sách (dựa trên vị trí của nút "Xóa" trong DOM)
            const index = $(this).parent().MaKH;
            console.log(index);
            // Lấy mảng sản phẩm từ local storage
            let CacNguoiDung = JSON.parse(localStorage.getItem('CacNguoiDung')) || [];
            console.log(CacNguoiDung);

            alert("Người dùng đã bị xóa khỏi hệ thống ?")
            // Xóa đối tượng sản phẩm khỏi mảng
            CacNguoiDung.splice(index, 1);
            console.log(CacNguoiDung);

            // Cập nhật lại mảng sản phẩm trong local storage
            localStorage.setItem('CacNguoiDung', JSON.stringify(CacNguoiDung));
            var i = 1;
            // Hiển thị danh sách sản phẩm và hình ảnh trong ứng dụng
            $('#DanhSachNguoiDung').empty();
            for (const NguoiDung of CacNguoiDung) {
                $('#DanhSachNguoiDung').append(
                    `
                    <tr style="border: rgb(235, 115, 167) solid 2px;; " >
                        <td class="col-1 text-center">${i}</td>
                        <td class="col-2">${NguoiDung.MaKH}</td>
                        <td class="col-3"><img src="${NguoiDung.Avt}" alt="" class="img-responsive"
                                style="max-width: 50%;"></td>
                        <td class="col-2">${NguoiDung.HoTen}</td>
                        <td class="col-1">${NguoiDung.Email}</td>
                        <td class="col-1">${NguoiDung.SDT}</td>
                        <td class="col-2">
                            <a href="#" class="btn btn-success edit" data-bs-toggle="modal" data-bs-target="#modalId${i}"><i class="fa fa-pencil"></i></a>
                            <a href="#" class="btn btn-danger delete"><i class="fa fa-trash"></i></a>
                        
                        
                            
                            <div class="modal fade" id="modalId${i}" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
                                <div class="modal-dialog" role="document" >
                                    <div class="modal-content">
                                            <div class="modal-header text-white " style="background-color: rgb(235, 115, 167);">
                                                <div  class="row w-100">
                                                    <h5 class="modal-title col" id="modalTitleId">CẬP NHẬT NGƯỜI DÙNG</h5>
                                                    <button type="button" class="btn-close col-1" data-bs-dismiss="modal" style="background-color:white" aria-label="Close"></button>
                                                </div>
                                                </div>
                                        <div class="modal-body">
                                            <div class="container-fluid">
                                                <form id="CapNhatNguoiDung">
                                                    <div class="container">
                                                        <div class="mb-3">
                                                            <input type="text" class="form-control"  hidden  value="${NguoiDung.MaKH}" name="MaKH" id="MaKH" aria-describedby="helpId"
                                                                placeholder="Nhập tên sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label text-uppercase" style="font-weight: bold;">Tên sản
                                                                phẩm</label>
                                                            <input type="text" class="form-control"  value="${NguoiDung.HoTen}" name="CapNhatTenKH" id="CapNhatTenKH" aria-describedby="helpId"
                                                                placeholder="Nhập tên sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label text-uppercase" style="font-weight: bold;">Số lượng</label>
                                                            <input type="number" class="form-control"  value="${NguoiDung.Email}" name="CapNhatEmail" id="CapNhatEmail" aria-describedby="helpId"
                                                                placeholder="Nhập số lượng sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label text-uppercase" style="font-weight: bold;">Giá bán</label>
                                                            <input type="number" class="form-control"  value="${NguoiDung.SDT}" name="CapNhatSDT" id="CapNhatSDT" aria-describedby="helpId"
                                                                placeholder="Nhập giá bán sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label">Hình sản phẩm</label>
                                                            <input type="file" class="form-control"  name="CapNhatAvt" id="CapNhatAvt" placeholder=""
                                                                aria-describedby="fileHelpId">
                                                        </div>
                                                        <div class="mb-3">
                                                            <img src="${NguoiDung.Avt}" alt="" class="img-fluid"
                                                        </div>
                                                        <button type="submit" class="btn  m-2 text-white"
                                                            style="float: right;  background-color:  rgb(235, 115, 167);">Cập nhật người dùng</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                       
                                    </div>
                                </div>
                            </div>
                          
                        </td>
                    </tr>
                `
                );
                i++;
            }
        });
    </script>
    <script>

        //CẬP NHẬT người dùng
        // Lắng nghe sự kiện khi người dùng gửi biểu mẫu cập nhật người dùng
        $('#CapNhatNguoiDung').submit(function (event) {
            // Ngăn chặn việc gửi mặc định của biểu mẫu
            event.preventDefault();

            // Lấy thông tin sản phẩm cần cập nhật
            const index = $('#MaKH').val();
            console.log(index);
            const HoTen = $('#CapNhatTenKH').val();
            const SDT = $('#CapNhatSDT').val();
            const Email = $('#CapNhatEmail').val();

            // Lấy mảng sản phẩm từ local storage
            let CacNguoiDung = JSON.parse(localStorage.getItem('CacNguoiDung')) || [];

            let NguoiDungCapNhat = CacNguoiDung.find(NguoiDungCapNhat => NguoiDungCapNhat.MaKH === index);

            // Cập nhật thông tin sản phẩm và đường dẫn của ảnh (nếu có)
            if ($('#CapNhatAvt')[0].files.length > 0) {
                const Avt = $('#CapNhatAvt')[0].files[0];
                const reader = new FileReader();

                reader.onload = function () {
                    NguoiDungCapNhat.HoTen = HoTen;
                    NguoiDungCapNhat.SDT = SDT;
                    NguoiDungCapNhat.Email = Email;
                    NguoiDungCapNhat.Avt = reader.result;

                    localStorage.setItem('CacNguoiDung', JSON.stringify(CacNguoiDung));
                }
                reader.readAsDataURL(Avt);
            } else {
                NguoiDungCapNhat.HoTen = HoTen;
                NguoiDungCapNhat.SDT = SDT;
                NguoiDungCapNhat.Email = Email;
                localStorage.setItem('CacNguoiDung', JSON.stringify(CacNguoiDung));
            }

            alert('Cập Nhật người dùng thành công');
            $('.btn-close').click();
            location.reload();
            // Hiển thị lại danh sách sản phẩm và hình ảnh
            var i = 1;
            // Hiển thị danh sách sản phẩm và hình ảnh trong ứng dụng
            $('#DanhSachNguoiDung').empty();
            for (const NguoiDung of CacNguoiDung) {
                $('#DanhSachNguoiDung').append(
                    `
                    <tr style="border: rgb(235, 115, 167) solid 2px;; " >
                        <td class="col-1 text-center">${i}</td>
                        <td class="col-2">${NguoiDung.MaKH}</td>
                        <td class="col-3"><img src="${NguoiDung.Avt}" alt="" class="img-responsive"
                                style="max-width: 50%;"></td>
                        <td class="col-2">${NguoiDung.HoTen}</td>
                        <td class="col-1">${NguoiDung.Email}</td>
                        <td class="col-1">${NguoiDung.SDT}</td>
                        <td class="col-2">
                            <a href="#" class="btn btn-success edit" data-bs-toggle="modal" data-bs-target="#modalId${i}"><i class="fa fa-pencil"></i></a>
                            <a href="#" class="btn btn-danger delete"><i class="fa fa-trash"></i></a>
                        
                        
                            
                            <div class="modal fade" id="modalId${i}" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
                                <div class="modal-dialog" role="document" >
                                    <div class="modal-content">
                                            <div class="modal-header text-white " style="background-color: rgb(235, 115, 167);">
                                                <div  class="row w-100">
                                                    <h5 class="modal-title col" id="modalTitleId">CẬP NHẬT NGƯỜI DÙNG</h5>
                                                    <button type="button" class="btn-close col-1" data-bs-dismiss="modal" style="background-color:white" aria-label="Close"></button>
                                                </div>
                                                </div>
                                        <div class="modal-body">
                                            <div class="container-fluid">
                                                <form id="CapNhatNguoiDung">
                                                    <div class="container">
                                                        <div class="mb-3">
                                                            <input type="text" class="form-control"  hidden  value="${NguoiDung.MaKH}" name="MaKH" id="MaKH" aria-describedby="helpId"
                                                                placeholder="Nhập tên sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label text-uppercase" style="font-weight: bold;">Tên sản
                                                                phẩm</label>
                                                            <input type="text" class="form-control"  value="${NguoiDung.HoTen}" name="CapNhatTenKH" id="CapNhatTenKH" aria-describedby="helpId"
                                                                placeholder="Nhập tên sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label text-uppercase" style="font-weight: bold;">Số lượng</label>
                                                            <input type="number" class="form-control"  value="${NguoiDung.Email}" name="CapNhatEmail" id="CapNhatEmail" aria-describedby="helpId"
                                                                placeholder="Nhập số lượng sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label text-uppercase" style="font-weight: bold;">Giá bán</label>
                                                            <input type="number" class="form-control"  value="${NguoiDung.SDT}" name="CapNhatSDT" id="CapNhatSDT" aria-describedby="helpId"
                                                                placeholder="Nhập giá bán sản phẩm tại đây">
                                                        </div>
                                                        <div class="mb-3">
                                                            <label for="" class="form-label">Hình sản phẩm</label>
                                                            <input type="file" class="form-control"  name="CapNhatAvt" id="CapNhatAvt" placeholder=""
                                                                aria-describedby="fileHelpId">
                                                        </div>
                                                        <div class="mb-3">
                                                            <img src="${NguoiDung.Avt}" alt="" class="img-fluid"
                                                        </div>
                                                        <button type="submit" class="btn  m-2 text-white"
                                                            style="float: right;  background-color:  rgb(235, 115, 167);">Cập nhật người dùng</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                       
                                    </div>
                                </div>
                            </div>
                          
                        </td>
                    </tr>
                `
                );
                i++;
            }
        }
        );

    </script>
</body>

</html>